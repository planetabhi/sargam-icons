@use "@new-ui/reset";
@use "@new-ui/colors";

@font-face {
  font-family: "Jiva Mono";
  src: url("../fonts/JivaMono.woff2") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

:root {
  font-size: 16px;
  --sargam: "Jiva Mono", ui-monospace, Menlo, Consolas, monospace;
  scroll-behavior: smooth;
  scroll-padding-top: 2rem;
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  --container-max-width: 100%;
  --container-padding: var(--s-16);
  --container-padding-mobile: 1.5rem;
  --shadow-color: rgb(0 0 0 / 0.04);
  --elevated-shadow: 0 0 0 1.5px var(--border-muted),
    0 1px 1px -0.5px var(--shadow-color), 0 3px 3px -1.5px var(--shadow-color);
  --s-00: 0rem;
  --s-01: .0625rem;
  --s-02: .125rem;
  --s-04: .25rem;
  --s-06: .375rem;
  --s-08: .5rem;
  --s-12: .75rem;
  --s-16: 1rem;
  --s-20: 1.25rem;
  --s-24: 1.5rem;
  --s-32: 2rem;
  --s-40: 2.5rem;
  --s-48: 3rem;
  --s-56: 3.5rem;
  --s-64: 4rem;
  --s-72: 4.5rem;
  --s-80: 5rem;
  --s-96: 6rem;
  --s-112: 7rem;
  --s-120: 7.5rem;
  --s-128: 8rem;
  --s-160: 10rem;
  --c-text: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' height='24' width='24'%3E%3Cpath fill='black' d='M9 4H11V5H9V4ZM12 6H11V5H12V6ZM13 6H12V18H11V19H9V20H11V19H12V18H13V19H14V20H16V19H14V18H13V6ZM14 5V6H13V5H14ZM14 5V4H16V5H14Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3Cpath fill='white' d='M15 3H16V4H15H14V3H15ZM14 5V4H13V5H12V4H11V3H10H9V4H8V5H9V6H10H11V18H10H9V19H8V20H9V21H10H11V20H12V19H13V20H14V21H15H16V20H17V19H16V18H15H14V6H15H16V5H17V4H16V5H15H14ZM13 6V5H14V6H13ZM13 18V6H12V5H11V4H10H9V5H10H11V6H12V18H11V19H10H9V20H10H11V19H12V18H13ZM13 18V19H14V20H15H16V19H15H14V18H13Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3C/svg%3E"
    ) 16 16, auto;
  --c-pointer: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M9 4H11V5H9V4ZM9 10V8V5H8V8V10H6V11H5V13H6V14H7V16H8V17H9V18H10V20H11H12H13H14V19H15H16V20H17V19H18V17H19V15H20V10H19V9H18H17V8H15H14V7H12V5H11V8V10H12V8H14V10H15V9H17V11H18V10H19V15H18V17H17V13H16V17H17V18V19H16V18H14V19H13H12H11V18H10V17H9V16H8V13H7H6V11H8V12H9V13H10V12V10H9ZM9 10H8V11H9V10ZM14 13H15V17H14V13ZM13 13H12V17H13V13Z' fill='black'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M9 5H11V8V10H12V8H14V10H15V9H17V10V11H18V10H19V15H18V17H17V13H16V17H17V18V19H16V18H14V19H13H12H11V18H10V17H9V16H8V13H6V11H8V12H9V13H10V12V10H9V8V5ZM12 13V17H13V13H12ZM14 13V17H15V13H14Z' fill='white'/%3E%3C/svg%3E"
    ) 10 5, pointer;
  --c-arrow: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' height='24' width='24'%3E%3Cpath fill='black' d='M9 5H8V16H9V15H10V14H11V15H12V17H13V19H14H15V17H14V15H13V13H14H15H16V12H15V11H14V10H13V9H12V8H11V7H10V6H9V5Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3Cpath fill='white' d='M8 4H9V5H8V4ZM8 16H7V5H8V16ZM9 16V17H8V16H9ZM10 15V16H9V15H10ZM11 15H10V14H11V15ZM12 17H11V16V15H12V16V17ZM13 19H12V18V17H13V18V19ZM15 19V20H14H13V19H14H15ZM15 17H16V18V19H15V18V17ZM14 15H15V16V17H14V16V15ZM13 14V15H14V14H16V13H17V12H16V11H15V10H14V9H13V8H12V7H11V6H10V5H9V6H10V7H11V8H12V9H13V10H14V11H15V12H16V13H13V14Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3C/svg%3E"
    ) 12 12, text;
  --c-grab: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' height='24' width='24'%3E%3Cpath fill='black' d='M13 4H11V5H10V6H9V5H7V6H6V8H7V10H5V11H4V13H5V14H6V16H7V17H8V18H9V20H10H11H12H13V19H14H15V20H16V19H17V17H18V15H19V12H20V8H19V7H18V8H17V6H16V5H14H13V4ZM13 5V10H14V6H16V11H17V9H18V8H19V12H18V15H17V17H16V13H15V17H16V19H15V18H14H13V19H12H11H10V18H9V17H8V16H7V14H6V13H5V11H7V12H8V13H9V10H8V8H7V6H9V8H10V10H11V5H13ZM8 10V11H7V10H8ZM14 13H13V17H14V13ZM11 13H12V17H11V13Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3Cpath fill='white' d='M13 5H11V10H10V8H9V6H7V8H8V10H9V12V13H8V12H7V11H5V13H6V14H7V16H8V17H9V18H10V19H11H12H13V18H15V19H16V18V17H17V15H18V12H19V8H18V9H17V11H16V10V6H14V10H13V5ZM14 13H13V17H14V13ZM12 13H11V17H12V13ZM16 13H15V17H16V13Z' clip-rule='evenodd' fill-rule='evenodd'/%3E%3C/svg%3E") 12 12, grab;
}

html[data-new-ui-theme*="dark"] {
  --link: #E08742;
  --link-hover: #E9F37E;
  --link-visited: #E08742;
  --border-focus: #E08742;
}

html[data-new-ui-theme*="light"] {
  --link: #C5773A;
  --link-hover: #9EA556;
  --link-visited: #C5773A;
  --border-focus: #C5773A;
}

@mixin container-base {
  max-width: var(--container-max-width);
  width: 100%;
  margin-inline: auto;
  padding-inline: var(--container-padding);
  box-sizing: border-box;
}

.container {
  @include container-base;
}

html,
body {
  background-color: var(--background);
  cursor: var(--c-arrow);
}

body {
  color: var(--content-primary);
  font: 400 1em/1.5 var(--sargam);
  margin: var(--s-00);
  font-kerning: normal;
  overflow-wrap: break-word;
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  &.font-loading {
    font-family: system-ui, sans-serif;
  }

  &.font-loaded {
    font-family: var(--sargam);
  }
}

body:after {
  content: "";
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: repeating-linear-gradient(0deg, var(--link) 0, var(--link) 2px, transparent 2px, transparent 4px);
  animation: lines 3s ease-out infinite;
  opacity: .2;
  mix-blend-mode: color-burn;
  pointer-events: none;
  display: none;
}

@keyframes lines {
  to {
    background-position: 0 25px
  }
}

p,
h1,
h2,
h3,
h4,
h5,
h6,
li,
pre,
code,
strong,
dl,
dt {
  cursor: var(--c-text);
}

a,
a * {
  cursor: var(--c-pointer);
}

main {
  width: 100%;
  margin: 0;
  padding: 0;

  #icon-grid .flex-grid {
    @include container-base;
  }
}

img,
svg {
  max-width: 100%;
  height: auto;
  aspect-ratio: 1 / 1;
}

:focus-visible {
  outline: 1.5px solid var(--border-focus);
  outline-offset: var(--s-02);
  box-shadow: none;
}

.flex-grid-item:focus,
.flex-grid-item:focus-visible {
  outline: none;
}

.flex-grid-item:focus img,
.flex-grid-item:focus-visible img {
  outline: 1.5px solid var(--border-focus);
  outline-offset: 2px;
}

.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--background-primary);
  color: var(--content-secondary);
  padding: var(--s-04);
  text-decoration: none;
  z-index: 1000;
  font-size: 0.875rem;

  &:focus {
    top: 6px;
  }
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

::selection {
  background: var(--content-inked);
  color: var(--background);
  text-shadow: none;
}

a {
  color: var(--link);
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 3px;
  position: relative;
  text-transform: uppercase;

  &:hover {
    color: var(--link-hover);
  }

  &:visited {
    color: var(--link-visited);
  }
}

img,
.flex-grid-item img[data-type="line"],
.flex-grid-item img[data-type="duotone"],
.flex-grid-item img[data-type="fill"] {
  position: relative;
}

header {
  width: 100%;
  margin: var(--s-112) 0 var(--s-56);
  text-align: center;
  padding: 0;

  .header-content {
    @include container-base;
    text-align: center;
    max-inline-size: 40rem;
  }

  h1 {
    font: 400 1.75rem/2.25rem var(--sargam);
    color: var(--content-primary);
    margin-bottom: var(--s-20);
    font-synthesis: none;
    text-rendering: optimizeLegibility;

    span {
      font: italic normal 1em var(--sargam);
    }
  }

  .CTAs {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--s-08);
    min-width: max-content;
    box-sizing: border-box;

    a {
      font: 400 0.875rem/1.563rem var(--sargam);
      padding: var(--s-02) var(--s-12);
      text-transform: uppercase;
      text-decoration-line: none;
      cursor: var(--c-pointer);
      color: var(--link);
      background: var(--background-high-contrast);

      border-left-color: var(--border-muted);
      border-top-color: var(--border-muted);
      border-right-color: var(--border-strong);
      border-bottom-color: var(--border-strong);
      border-style: solid;
      border-width: 1px;

      &:hover {
        color: var(--link-hover);
      }

      &:active {
        border-left-color: var(--border-strong);
        border-top-color: var(--border-strong);
        border-right-color: var(--border-muted);
        border-bottom-color: var(--border-muted);
      }
    }
  }
}

.flex-grid {
  display: flex;
  flex-wrap: wrap;

  &-item {
    flex: 1 0 calc(var(--s-64) * var(--zoom, 1));
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    margin: 0 calc(var(--s-02) * var(--zoom, 1)) calc(var(--s-04) * var(--zoom, 1));
    height: calc(9.5rem * var(--zoom, 1));
    background: var(--background-high-contrast);
    content-visibility: auto;
    contain-intrinsic-size: 0 calc(9.5rem * var(--zoom, 1));
    border: 1.5px dotted var(--border-muted);

    img {

      &[data-type="line"],
      &[data-type="duotone"],
      &[data-type="fill"] {
        width: calc(24px * var(--zoom, 1));
        height: calc(24px * var(--zoom, 1));
        position: absolute;
        object-fit: contain;
        aspect-ratio: 1 / 1;
        cursor: var(--c-pointer);

        &:hover {
          background: var(--content-secondary-alt);
          color: var(--content-primary);
        }
      }

      &[data-type="line"] {
        top: calc(1.25rem * var(--zoom, 1));
      }

      &[data-type="duotone"] {
        top: calc(4rem * var(--zoom, 1));
      }

      &[data-type="fill"] {
        top: calc(6.75rem * var(--zoom, 1));
      }
    }
  }
}

.top-nav {
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  display: flex;
  z-index: 999;
  position: fixed;
  inset: 0% 0% auto;
  border-bottom: 1.5px solid var(--border-muted);
  background: var(--background);

  &-inner {
    max-width: var(--container-max-width);
    width: 100%;
    margin: 0 auto;
    padding: var(--s-08);
    box-sizing: border-box;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--s-06);
  }

  .lhs,
  .rhs {
    display: flex;
    align-items: center;
    gap: var(--s-06);
  }

  a {
    color: var(--content-secondary);
    text-decoration: none;
    font: 400 14px/1.5 var(--sargam);

    &:hover {
      text-decoration: none;
      color: var(--content-primary);
    }
  }

  .nav-search-wrapper {
    position: relative;
    margin-left: var(--s-00);

    input[type="search"] {
      width: 12rem;
      box-sizing: border-box;
      background-color: var(--background);
      box-shadow: none;
      appearance: none;
      border: 1.5px solid var(--border-muted);
      text-align: left;
      font: 400 0.875rem/1.5 var(--sargam);
      padding: var(--s-02) var(--s-06);
      color: var(--content-primary);
      caret-color: var(--content-primary);
      text-transform: uppercase;
      cursor: var(--c-text);

      &::placeholder {
        color: var(--content-placeholder);
      }

      &:focus {
        border-color: var(--border-focus);
        outline: 0;
        box-shadow: 0 0 0 .5px var(--border-focus);
      }

      &::-webkit-search-cancel-button {
        display: none;
      }
    }

    .clear-search {
      position: absolute;
      right: var(--s-04);
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      border: none;
      background: transparent;
      padding: 0;
      margin: 0;
      cursor: var(--c-pointer);
      color: var(--content-secondary-alt);
      display: inline-flex;
      align-items: center;
      justify-content: center;

      &:focus {
        outline: 0;
        box-shadow: 0 0 0 .5px var(--border-focus);
      }

      &[hidden] {
        display: none;
      }

      svg {
        width: 16px;
        height: 16px;
      }
    }
  }
}

@keyframes rotate {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.brand {
  display: inline-flex;
  align-items: center;
  gap: 8px;

  svg {
    animation: rotate 4s linear infinite;
    animation-play-state: paused;
  }

  svg:hover,
  &:hover svg {
    animation-play-state: running;
  }
}

.version-pill {
  font: 400 14px/1 var(--sargam);
  padding: var(--s-02) var(--s-04);
  color: var(--content-primary);
  background: var(--background-selected);
}

.zoom-separator {
  width: 1px;
  height: 1rem;
  background: var(--border-muted);
  margin: 0 var(--s-04);
}

.zoom-btn {
  width: 32px;
  height: 32px;
  padding: 0;
  cursor: var(--c-pointer);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--content-secondary);
  background: none;
  border: 1.5px solid var(--border-muted);
  transition: transform 0.1s ease;

  &:hover:not(:disabled) {
    border: 1.5px solid var(--border);
    color: var(--content-primary);
    background: var(--background-high-contrast);
  }

  &:focus {
    outline: 0;
    box-shadow: 0 0 0 .5px var(--border-focus);
  }

  &:active:not(:disabled) {
    transform: scale(0.97);
  }

  &:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    border: 1px solid transparent;
  }

  svg {
    width: 16px;
    height: 16px;
    display: block;
  }
}

.theme-toggle {
  width: 32px;
  height: 32px;
  padding: 0;
  cursor: var(--c-pointer);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--content-secondary);
  background: none;
  border: 1.5px solid var(--border-muted);
  transition: transform 0.1s ease;

  &:hover {
    border: 1.5px solid var(--border);
    color: var(--content-primary);
    background: var(--background-high-contrast);
  }

  &:focus {
    outline: 0;
    box-shadow: 0 0 0 .5px var(--border-focus);
  }

  &:active {
    transform: scale(0.97);
  }

  svg {
    width: 16px;
    height: 16px;
    display: block;
  }
}

.blank {
  height: 0;
}

.details {
  max-width: 40rem;
  width: 100%;
  margin: 2.5rem auto;
  padding-inline: var(--container-padding);
  box-sizing: border-box;
  font: normal 1rem/1.5 var(--sargam);
  color: var(--content-secondary);

  li {
    list-style-type: decimal;
    padding-inline-start: 1ch;
  }
}

footer {
  width: 100%;
  padding: 1rem 0;
  margin: 0;
  text-align: center;
  font: normal 0.875rem/1.5 var(--sargam);
  color: var(--content-secondary);
  border-top: 1px dotted var(--border-muted);

  .footer-content {
    @include container-base;
  }

  a {
    color: var(--link-hover);
  }
}

.gradient-blur-top {
  position: fixed;
  top: 2rem;
  left: 0;
  right: 0;
  z-index: 50;
  height: 5.2rem;
  pointer-events: none;

  &::before,
  &::after,
  >div {
    position: absolute;
    inset: 0;
  }

  @mixin blur-layer($z-index,
    $blur,
    $mask-start,
    $mask-end,
    $opacity-start: 1,
    $opacity-mid: 0.8,
    $opacity-end: 0) {
    z-index: $z-index;
    backdrop-filter: blur($blur);
    background: linear-gradient(180deg,
        var(--background) 0%,
        transparent $mask-end );
    mask: linear-gradient(180deg,
        rgba(0, 0, 0, $opacity-start) $mask-start,
        rgba(0, 0, 0, $opacity-mid) calc($mask-start + ($mask-end - $mask-start) / 2),
        rgba(0, 0, 0, $opacity-end) $mask-end );
  }

  &::before {
    content: "";
    @include blur-layer(1, 0.5px, 0%, 37.5%, 1, 0.96, 0);
  }

  >div {
    &:nth-of-type(1) {
      @include blur-layer(2, 1px, 12.5%, 50%, 0, 0.88, 0);
    }

    &:nth-of-type(2) {
      @include blur-layer(3, 2px, 25%, 62.5%, 0, 0.72, 0);
    }

    &:nth-of-type(3) {
      @include blur-layer(4, 4px, 37.5%, 75%, 0, 0.64, 0);
    }

    &:nth-of-type(4) {
      @include blur-layer(5, 8px, 50%, 87.5%, 0, 0.32, 0);
    }

    &:nth-of-type(5) {
      @include blur-layer(6, 16px, 62.5%, 100%, 0, 0.24, 0);
    }

    &:nth-of-type(6) {
      @include blur-layer(7, 32px, 75%, 100%, 0, 0.12, 0);
    }
  }

  &::after {
    content: "";
    @include blur-layer(8, 64px, 87.5%, 100%, 0, 0.05, 0);
  }
}

.icon-popover {
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;

  &[hidden] {
    display: none;
  }

  &[hidden] .popover-content {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition-delay: 0s;
  }
}

.popover-content {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 1;
  background: var(--background-high-contrast);
  width: 100%;
  max-width: 16rem;
  pointer-events: auto;
  border: 2px solid var(--black);
  visibility: visible;

  --ease-in: cubic-bezier(0.4, 0, 0.2, 1);
  transition-property: opacity, visibility;
  transition-duration: .2s;
  transition-timing-function: var(--ease-in);
  transition-delay: .2s;
  opacity: 1;

  --popover-shadow: 6px 6px 0px 0px var(--border);
  box-shadow: var(--popover-shadow);
}

.popover-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--s-00) var(--s-00) var(--s-00) var(--s-06);
  border-bottom: 2px solid var(--background-high-contrast);
  cursor: var(--c-grab);
  user-select: none;

  &:active {
    cursor: grabbing;
  }

  .popover-icon-name {
    font: 400 0.875rem/1.5 var(--sargam);
    color: var(--content-primary);
    margin: 0;
    text-transform: uppercase;
    cursor: var(--c-grab);
  }

  .popover-close {
    width: 28px;
    height: 28px;
    padding: 0;
    margin-left: var(--s-08);
    cursor: var(--c-pointer);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: var(--content-secondary);
    background: none;
    transition: transform 0.1s ease;
    border: none;

    &:hover {
      color: var(--content-primary);
      background: var(--background);
    }

    &:focus-visible {
      outline: 0;
      box-shadow: 0 0 0 .5px var(--border-focus);
    }

    &:active {
      transform: scale(0.97);
    }

    svg {
      width: 16px;
      height: 16px;
      display: block;
    }
  }
}

.popover-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--s-32);
  background: var(--background);

  .popover-icon {
    width: 128px;
    height: 128px;
    object-fit: contain;
  }
}

.popover-menu {
  display: flex;
  flex-direction: column;
  gap: 0;
  border-top: .5px solid var(--border-muted);
}

.popover-menu-item {
  display: flex;
  align-items: center;
  gap: var(--s-08);
  padding: var(--s-04);
  font: 400 0.875rem/1.5 var(--sargam);
  color: var(--content-secondary);
  background: none;
  border: none;
  border-bottom: .5px solid var(--border-muted);
  cursor: var(--c-pointer);
  text-align: left;
  text-transform: uppercase;
  transition: transform 0.1s ease;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    color: var(--content-primary);
    background: var(--background);
  }

  &:focus {
    outline: 0;
    box-shadow: inset 0 0 0 1.5px var(--border-focus);
  }

  &:active {
    transform: scale(0.98);
  }

  svg {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  span {
    flex: 1;
  }
}

@media screen and (max-width: 639px) {
  :root {
    --container-padding: var(--container-padding-mobile);
  }

  header {
    margin: var(--s-128) 0 var(--s-64);
  }

  .details {
    margin: var(--s-64) 0;
  }

  .top-nav-inner {
    margin: 0 auto 0;
  }

  .popover-content {
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: var(--s-12);
    min-width: auto;
    max-width: calc(100vw - var(--s-24));
  }

  .popover-header {
    cursor: default !important;
    user-select: auto;

    &:active {
      cursor: default !important;
    }
  }

  .nav-search-wrapper {
    display: none;
  }

  .top-nav .lhs {
    gap: var(--s-04);
  }
}

[data-new-ui-theme="dark--warm"] {

  img[data-type="line"],
  img[data-type="duotone"],
  img[data-type="fill"],
  .popover-icon {
    filter: invert(1) sepia(100%) hue-rotate(180deg);
  }

}